{"version":3,"sources":["webpack:///./src/views/operation/individual-rebate.vue?e816","webpack:///./src/views/operation/individual-rebate.vue","webpack:///src/views/operation/individual-rebate.vue"],"names":["operation_individual_rebate","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","inline","label","label-width","staticStyle","width","placeholder","maxlength","clearable","model","value","callback","$$v","searchedAgentId","expression","_v","margin-right","type","on","click","handleSearchAgent","margin-top","color","columns","tableColumns","data","tableRows","border","staticRenderFns","__vue_styles__","ssrContext","__webpack_require__","Component","normalizeComponent","individual_rebate","__webpack_exports__","_this","title","key","align","h","params","row","avatar","indexOf","src","style","height","border-radius","isBeingEdited","props","directRebateRatioInputValue","step","min","max","formatter","toFixed","parser","replace","on-change","newValue","directRebateRatio","subordinateRebateRatioInputValue","subordinateRebateRatio","marginRight","submitRowChange","cancelRowChange","index","hasIndividualRebateRatio","beginChangeRow","onClickIndividualRebateRatioCancelBtn","beingEditedRowIndex","isShowingAgentWithoutIndividualRebateRatio","latestSearch","created","queryAllAgentsWithIndividualRebateRatio","methods","trim","length","agentId","parseInt","isNaN","$Message","error","queryAgentRebateRatioInfo","_this2","$http","post","global","url","query_agents_individual_rebate_ratio_info","then","records","i","push","id","agent_id","name","commerceId","commerce_id","commerceName","commerce_name","direct_rebate_ratio","subordinate_rebate_ratio","has_individual_rebate_ratio","agentLevelName","getAgentLevelNameByLevel","agent_level","_this3","query_agent_individual_rebate_ratio_info","record","err_code","err_msg","_this4","update_agent_individual_rebate_ratio_info","info","_this5","$Modal","confirm","content","onOk","cancelIndividualRebateRatio","_this6","cancel_agent_individual_rebate_ratio","level","toString"],"mappings":"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","file":"static/js/21.f8e9288d7f3be3b42a8e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('div',{staticClass:\"content-bar\"},[_c('Form',{attrs:{\"inline\":\"\"}},[_c('FormItem',{attrs:{\"label\":\"代理ID\",\"label-width\":80}},[_c('Input',{staticStyle:{\"width\":\"10em\"},attrs:{\"placeholder\":\"代理ID\",\"maxlength\":6,\"clearable\":\"\"},model:{value:(_vm.searchedAgentId),callback:function ($$v) {_vm.searchedAgentId=$$v},expression:\"searchedAgentId\"}})],1),_vm._v(\" \"),_c('FormItem',{attrs:{\"label-width\":0}},[_c('Button',{staticStyle:{\"margin-right\":\"10px\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSearchAgent}},[_vm._v(\"查询\")])],1)],1)],1),_vm._v(\" \"),_c('div',{staticStyle:{\"margin-top\":\"10px\"}},[(_vm.isShowingAgentWithoutIndividualRebateRatio)?_c('div',{staticStyle:{\"color\":\"red\"}},[_vm._v(\"该代理尚未被授予独立返利比例：\")]):_c('div',[_vm._v(\"被授予独立返利比例的代理：\")])]),_vm._v(\" \"),_c('Table',{attrs:{\"columns\":_vm.tableColumns,\"data\":_vm.tableRows,\"border\":\"\"}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-e1c846de\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/operation/individual-rebate.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-e1c846de\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./individual-rebate.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./individual-rebate.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./individual-rebate.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-e1c846de\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./individual-rebate.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/operation/individual-rebate.vue\n// module id = null\n// module chunks = ","<template>\r\n  <div>\r\n    <div class=\"content-bar\">\r\n      <Form inline>\r\n        <FormItem label=\"代理ID\" :label-width=\"80\">\r\n          <Input v-model=\"searchedAgentId\" placeholder=\"代理ID\" :maxlength=\"6\" clearable style=\"width: 10em;\"/>\r\n        </FormItem>\r\n\r\n\r\n        <FormItem :label-width=\"0\"> <Button type=\"primary\" @click=\"handleSearchAgent\" style=\"margin-right: 10px;\">查询</Button></FormItem>\r\n        </FormItem>\r\n      </Form>\r\n\r\n    </div>\r\n    <div style=\"margin-top: 10px;\">\r\n      <div v-if=\"isShowingAgentWithoutIndividualRebateRatio\" style=\"color: red;\">该代理尚未被授予独立返利比例：</div>\r\n      <div v-else>被授予独立返利比例的代理：</div>\r\n    </div>\r\n    <Table :columns=\"tableColumns\" :data=\"tableRows\" border>\r\n    </Table>\r\n  </div>\r\n</template>\r\n<style>\r\n  @import \"../../assets/style/common.css\";\r\n</style>\r\n<script>\r\n  export default {\r\n    data() {\r\n      return {\r\n        tableColumns: [\r\n          { title: \"游戏内id\", key: \"id\", align: \"center\", width: 100 },\r\n          { title: \"名称\", key: \"name\", align: \"center\", width: 150 },\r\n          {\r\n            title: \"头像\",\r\n            key: \"avatar\",\r\n            align: \"center\",\r\n            width: 80,\r\n            render: (h, params) => {\r\n              if (params.row.avatar.indexOf(\"http://\") == -1 && params.row.avatar.indexOf(\"https://\") == -1) {\r\n                return h(\"div\", \"\");\r\n              } else {\r\n                return h(\"img\", {\r\n                  attrs: {\r\n                    src: params.row.avatar\r\n                  },\r\n                  style: {\r\n                    width: \"40px\",\r\n                    height: \"40px\",\r\n                    \"border-radius\": \"5px\",\r\n                    \"margin-top\": \"5px\"\r\n                  }\r\n                });\r\n              }\r\n            }\r\n          },\r\n          { title: \"所属商务\", key: \"commerceName\", align: \"center\", width: 100 },\r\n          { title: \"代理等级\", key: \"agentLevelName\", align: \"center\", width: 100 },\r\n          {\r\n            title: \"直属返利比例\",\r\n            key: \"directRebateRatio\",\r\n            align: \"center\",\r\n            width: 120,\r\n            render: (h, params) => {\r\n              if (params.row.isBeingEdited) {\r\n                return h(\"InputNumber\", {\r\n                  props: {\r\n                    value: params.row.directRebateRatioInputValue,\r\n                    step: 0.01,\r\n                    min: 0,\r\n                    max: 1,\r\n                    formatter: value => `${(100 * value).toFixed(0)}%`,\r\n                    parser: value => (0.01 * value.replace(\"%\", \"\")).toFixed(2)\r\n                  },\r\n                  on: {\r\n                    \"on-change\": newValue => {\r\n                      params.row.directRebateRatioInputValue = newValue;\r\n                    }\r\n                  }\r\n                });\r\n              } else {\r\n                return h(\"div\", (100 * params.row.directRebateRatio).toFixed(0) + \"%\");\r\n              }\r\n            }\r\n          },\r\n          {\r\n            title: \"下级返利比例\",\r\n            key: \"subordinateRebateRatio\",\r\n            align: \"center\",\r\n            width: 120,\r\n            render: (h, params) => {\r\n              if (params.row.isBeingEdited) {\r\n                return h(\"InputNumber\", {\r\n                  props: {\r\n                    value: params.row.subordinateRebateRatioInputValue,\r\n                    step: 0.01,\r\n                    min: 0,\r\n                    max: 1,\r\n                    formatter: value => `${(100 * value).toFixed(0)}%`,\r\n                    parser: value => (0.01 * value.replace(\"%\", \"\")).toFixed(2)\r\n                  },\r\n                  on: {\r\n                    \"on-change\": newValue => {\r\n                      params.row.subordinateRebateRatioInputValue = newValue;\r\n                    }\r\n                  }\r\n                });\r\n              } else {\r\n                return h(\"div\", (100 * params.row.subordinateRebateRatio).toFixed(0) + \"%\");\r\n              }\r\n            }\r\n          },\r\n          {\r\n            title: \"操作\",\r\n            key: \"action\",\r\n            render: (h, params) => {\r\n              if (params.row.isBeingEdited) {\r\n                return h(\"div\", [\r\n                  h(\r\n                    \"Button\",\r\n                    {\r\n                      props: {\r\n                        type: \"primary\"\r\n                      },\r\n                      style: {\r\n                        marginRight: \"5px\"\r\n                      },\r\n                      on: {\r\n                        click: () => {\r\n                          this.submitRowChange(params.row);\r\n                        }\r\n                      }\r\n                    },\r\n                    \"确定\"\r\n                  ),\r\n                  h(\r\n                    \"Button\",\r\n                    {\r\n                      props: {\r\n                        type: \"error\"\r\n                      },\r\n                      on: {\r\n                        click: () => {\r\n                          this.cancelRowChange(params.index);\r\n                        }\r\n                      }\r\n                    },\r\n                    \"取消\"\r\n                  )\r\n                ]);\r\n              } else if (params.row.hasIndividualRebateRatio) {\r\n                return h(\"div\", [\r\n                  h(\r\n                    \"Button\",\r\n                    {\r\n                      props: {\r\n                        type: \"primary\"\r\n                      },\r\n                      style: {\r\n                        marginRight: \"5px\"\r\n                      },\r\n                      on: {\r\n                        click: () => {\r\n                          this.beginChangeRow(params.index);\r\n                        }\r\n                      }\r\n                    },\r\n                    \"调整独立返利比例\"\r\n                  ),\r\n                  h(\r\n                    \"Button\",\r\n                    {\r\n                      props: {\r\n                        type: \"error\"\r\n                      },\r\n                      on: {\r\n                        click: () => {\r\n                          this.onClickIndividualRebateRatioCancelBtn(params.row);\r\n                        }\r\n                      }\r\n                    },\r\n                    \"取消独立返利比例\"\r\n                  )\r\n                ]);\r\n              } else {\r\n                return h(\"Button\", {\r\n                  props: {\r\n                    type: \"primary\"\r\n                  },\r\n                  style: {\r\n                    marginRight: \"5px\"\r\n                  },\r\n                  on: {\r\n                    click: () => {\r\n                      this.beginChangeRow(params.index);\r\n                    }\r\n                  }\r\n                }, \"授予独立返利比例\");\r\n              }\r\n            }\r\n          }\r\n        ],\r\n        tableRows: [],\r\n        searchedAgentId: \"\",\r\n        beingEditedRowIndex: -1,\r\n        isShowingAgentWithoutIndividualRebateRatio: false,\r\n        latestSearch: null,\r\n      };\r\n    },\r\n\r\n    created() {\r\n      this.queryAllAgentsWithIndividualRebateRatio();\r\n    },\r\n\r\n    methods: {\r\n      handleSearchAgent() {\r\n        var isSearchingAllAgents = this.searchedAgentId.trim().length == 0;\r\n\r\n        if (isSearchingAllAgents) {\r\n          this.queryAllAgentsWithIndividualRebateRatio();\r\n        } else {\r\n          var agentId = parseInt(this.searchedAgentId.trim());\r\n          if (isNaN(agentId) || agentId <= 0) {\r\n            this.$Message.error(\"请正确输入代理id\");\r\n            return;\r\n          }\r\n\r\n          this.queryAgentRebateRatioInfo(agentId);\r\n        }\r\n      },\r\n\r\n      queryAllAgentsWithIndividualRebateRatio() {\r\n        // 清空table\r\n        this.tableRows = [];\r\n        this.isShowingAgentWithoutIndividualRebateRatio = false;\r\n\r\n        this.$http.post(global.url.query_agents_individual_rebate_ratio_info, {}).then(records => {\r\n          if (!records) {\r\n            return;\r\n          }\r\n\r\n          for (var i = 0; i < records.length; i++) {\r\n            this.tableRows.push({\r\n              id: records[i].agent_id,\r\n              name: records[i].name,\r\n              avatar: records[i].avatar,\r\n              commerceId: records[i].commerce_id,\r\n              commerceName: records[i].commerce_name,\r\n              directRebateRatio: records[i].direct_rebate_ratio,\r\n              subordinateRebateRatio: records[i].subordinate_rebate_ratio,\r\n              hasIndividualRebateRatio: (records[i].has_individual_rebate_ratio == 1),\r\n              agentLevelName: this.getAgentLevelNameByLevel(records[i].agent_level),\r\n              directRebateRatioInputValue: 0,\r\n              subordinateRebateRatioInputValue: 0,\r\n              isBeingEdited: false,\r\n            });\r\n          }\r\n        });\r\n\r\n        // 保存本次查询\r\n        this.latestSearch = () => { this.queryAllAgentsWithIndividualRebateRatio(); };\r\n      },\r\n\r\n      queryAgentRebateRatioInfo(agentId) {\r\n        // 清空table\r\n        this.tableRows = [];\r\n        this.isShowingAgentWithoutIndividualRebateRatio = false;\r\n\r\n        this.$http\r\n          .post(global.url.query_agent_individual_rebate_ratio_info, {\r\n            agentId: agentId\r\n          })\r\n          .then(record => {\r\n            if (!record) {\r\n              return;\r\n            }\r\n\r\n            if (record.err_code != 0) {\r\n              this.$Message.error(record.err_msg);\r\n              return;\r\n            }\r\n\r\n            this.tableRows.push({\r\n              id: record.agent_id,\r\n              name: record.name,\r\n              avatar: record.avatar,\r\n              commerceId: record.commerce_id,\r\n              commerceName: record.commerce_name,\r\n              directRebateRatio: record.direct_rebate_ratio,\r\n              subordinateRebateRatio: record.subordinate_rebate_ratio,\r\n              hasIndividualRebateRatio: (record.has_individual_rebate_ratio == 1),\r\n              agentLevelName: this.getAgentLevelNameByLevel(record.agent_level),\r\n              directRebateRatioInputValue: 0,\r\n              subordinateRebateRatioInputValue: 0,\r\n              isBeingEdited: false,\r\n            });\r\n\r\n            this.isShowingAgentWithoutIndividualRebateRatio = (record.has_individual_rebate_ratio == 0);\r\n          });\r\n\r\n        // 保存本次查询\r\n        this.latestSearch = () => { this.queryAgentRebateRatioInfo(agentId); };\r\n      },\r\n\r\n      submitRowChange(row) {\r\n        this.$http.post(global.url.update_agent_individual_rebate_ratio_info, {\r\n          agentId: row.id,\r\n          directRebateRatio: row.directRebateRatioInputValue,\r\n          subordinateRebateRatio: row.subordinateRebateRatioInputValue\r\n        }).then(record => {\r\n          if (!record) {\r\n            return;\r\n          }\r\n\r\n          if (record.err_code != 0) {\r\n            this.$Message.error(record.err_msg);\r\n          } else {\r\n            this.$Message.info(\"操作成功\");\r\n            row.isBeingEdited = false;\r\n\r\n            // 自动执行查询以刷新页面数据\r\n            this.latestSearch();\r\n          }\r\n        });\r\n      },\r\n\r\n      cancelRowChange(index) {\r\n        this.tableRows[index].isBeingEdited = false;\r\n        this.beingEditedRowIndex = -1;\r\n      },\r\n\r\n      beginChangeRow(index) {\r\n        if (this.beingEditedRowIndex >= 0) {\r\n          this.cancelRowChange(this.beingEditedRowIndex);\r\n        }\r\n\r\n        this.tableRows[index].isBeingEdited = true;\r\n        this.beingEditedRowIndex = index;\r\n        this.tableRows[index].directRebateRatioInputValue = this.tableRows[index].directRebateRatio;\r\n        this.tableRows[index].subordinateRebateRatioInputValue = this.tableRows[index].subordinateRebateRatio;\r\n      },\r\n\r\n      onClickIndividualRebateRatioCancelBtn(row) {\r\n        this.$Modal.confirm({\r\n          content: `<p>即将取消代理【${row.name}】的独立返利比例</p><p>取消后，该代理的返利比例将会是与其等级对应的默认值</p>`,\r\n          onOk: () => {\r\n            this.cancelIndividualRebateRatio(row.id);\r\n          }\r\n        });\r\n      },\r\n\r\n      cancelIndividualRebateRatio(agentId) {\r\n        this.$http.post(global.url.cancel_agent_individual_rebate_ratio, {\r\n          agentId: agentId\r\n        }).then(record => {\r\n          if (!record) {\r\n            return;\r\n          }\r\n\r\n          if (record.err_code != 0) {\r\n            this.$Message.error(record.err_msg);\r\n          } else {\r\n            this.$Message.info(\"操作成功\");\r\n\r\n            // 自动执行查询以刷新页面数据\r\n            this.latestSearch();\r\n          }\r\n        });\r\n      },\r\n\r\n      getAgentLevelNameByLevel(level) {\r\n        switch (level.toString()) {\r\n          case '1':\r\n            return \"预备代理\"\r\n          case '2':\r\n            return \"普通代理\"\r\n          case '3':\r\n            return \"铜牌代理\"\r\n          case '4':\r\n            return \"银牌代理\"\r\n          case '5':\r\n            return \"金牌代理\"\r\n          default:\r\n            return \"\";\r\n        }\r\n      }\r\n    }\r\n  };\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/operation/individual-rebate.vue"],"sourceRoot":""}